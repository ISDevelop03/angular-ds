<div id="ds-accordion" [ngClass]="getContainerClasses()">
  <div
    *ngFor="let item of localItems"
    [attr.data-open]="item.isOpen.toString()"
    [ngClass]="getDisclosureClasses(item.isOpen)"
  >
    <!-- header -->
    <button
      type="button"
      (click)="handleChange(item)"
      [ngClass]="getButtonClasses(item.isOpen)"
    >
      <div class="flex items-center justify-between gap-2">
        <div [class]="theme[variant].button.titleWrapper">
          <div *ngIf="item.count" [ngClass]="[
            'flex items-center flex-row-reverse gap-2'
          ]">
            <!-- count -->
            <span
              [ngClass]="[
                'rounded-full font-bold text-white text-[0.75rem]/[1rem] inline-flex justify-center items-center size-[20px]',
                item.countColor || 'bg-red-500'
              ]"
            >
              {{ item.count }}
            </span>
            <!-- title -->
            <span
              [ngClass]="[textClassName, theme[this.variant].button.title || '']"
              >{{ item.title }}</span
            >
          </div>
          <!-- title -->
          <span
            *ngIf="!item.count"
            [ngClass]="[textClassName, theme[this.variant].button.title || '']"
            >{{ item.title }}</span
          >
          <!-- icon -->
          <ds-icon
            [id]="getIconId(item.isOpen)"
            [size]="theme[variant].button.icon.size"
            [class]="getIconClasses(item.isOpen)"
          ></ds-icon>
        </div>
        <ng-container *ngIf="item.buttonTemplate">
          <ng-container *ngTemplateOutlet="item.buttonTemplate; context: item"></ng-container>
        </ng-container>
      </div>
    </button>


    <!-- panel -->
    <div *ngIf="item.isOpen" [ngClass]="getPanelClasses()">
      <ng-container *ngIf="isTemplate(item.content); else showHtml">
        <ng-container *ngTemplateOutlet="item.content; context: item.context"></ng-container>
      </ng-container>
      <ng-template #showHtml>
        <div [innerHTML]="item.content"></div>
      </ng-template>
    </div>
  </div>
</div>
